<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATTIA Mobile Shop - Simple Test</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Login Page -->
    <div id="login-container" class="login-container">
        <div class="login-card">
            <div class="login-header">
                <img src="attia logo.png" alt="ATTIA Logo" class="login-logo">
                <h1>ATTIA Mobile Shop</h1>
                <p>Management System (Simple Test)</p>
            </div>
            <form id="login-form" class="login-form">
                <div class="form-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" value="staff1" required>
                </div>
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" value="staff123" required>
                </div>
                <div class="form-group">
                    <label for="role">Role</label>
                    <select id="role" required>
                        <option value="">Select Role</option>
                        <option value="staff" selected>Staff</option>
                        <option value="admin">Admin</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary login-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    Login (Test Mode)
                </button>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="app-container" class="app-container" style="display: none;">
        <!-- Header -->
        <header class="header">
            <div class="header-left">
                <h1>ATTIA Mobile Shop (Test Mode)</h1>
            </div>
            <div class="header-right">
                <div class="user-info">
                    <span id="welcome-message">Welcome, User</span>
                    <span class="user-role" id="user-role">Role</span>
                </div>
                <button class="btn btn-secondary" id="logout-btn">
                    <i class="fas fa-sign-out-alt"></i>
                    Logout
                </button>
            </div>
        </header>

        <!-- Sidebar Navigation -->
        <nav class="sidebar">
            <ul class="nav-menu" id="nav-menu">
                <li class="nav-item active" data-section="dashboard">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </li>
                <li class="nav-item" data-section="inventory" data-roles="admin,staff">
                    <i class="fas fa-boxes"></i>
                    <span>Inventory</span>
                </li>
                <li class="nav-item" data-section="sales" data-roles="staff">
                    <i class="fas fa-receipt"></i>
                    <span>Create Receipt</span>
                </li>
            </ul>
        </nav>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboard" class="content-section active">
                <div class="section-header">
                    <h2>Dashboard</h2>
                </div>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-info">
                            <h3 id="total-products">3</h3>
                            <p>Available Products</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Inventory Section -->
            <section id="inventory" class="content-section">
                <div class="section-header">
                    <h2>Inventory Management</h2>
                </div>

                <div class="table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Brand</th>
                                <th>Model</th>
                                <th>Price</th>
                                <th>Stock</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="products-tbody">
                            <tr>
                                <td><strong>APL001</strong></td>
                                <td>Apple</td>
                                <td>iPhone 15 Pro</td>
                                <td>$999.99</td>
                                <td>25</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="testAddToReceipt(1)">
                                        <i class="fas fa-plus"></i> Add to Receipt
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>SAM002</strong></td>
                                <td>Samsung</td>
                                <td>Galaxy S24 Ultra</td>
                                <td>$899.99</td>
                                <td>30</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="testAddToReceipt(2)">
                                        <i class="fas fa-plus"></i> Add to Receipt
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td><strong>GOO003</strong></td>
                                <td>Google</td>
                                <td>Pixel 8 Pro</td>
                                <td>$699.99</td>
                                <td>15</td>
                                <td>
                                    <button class="btn btn-primary btn-sm" onclick="testAddToReceipt(3)">
                                        <i class="fas fa-plus"></i> Add to Receipt
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

            <!-- Sales Section -->
            <section id="sales" class="content-section">
                <div class="section-header">
                    <h2>Create Receipt</h2>
                </div>

                <!-- Receipt Builder -->
                <div id="receipt-builder" class="receipt-builder" style="display: none;">
                    <div class="receipt-card">
                        <h3><i class="fas fa-receipt"></i> Create New Receipt</h3>
                        
                        <div class="receipt-form">
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Customer Name</label>
                                    <input type="text" id="receipt-customer" placeholder="Enter customer name">
                                </div>
                                <div class="form-group">
                                    <label>Phone</label>
                                    <input type="text" id="receipt-phone" placeholder="Customer phone">
                                </div>
                            </div>
                        </div>

                        <div class="receipt-items">
                            <h4>Items</h4>
                            <div class="receipt-items-list" id="receipt-items-list">
                                <p class="no-items">No items added yet. Go to Inventory to add products.</p>
                            </div>
                            
                            <div class="receipt-total">
                                <div class="total-row">
                                    <span>Subtotal:</span>
                                    <span id="receipt-subtotal">$0.00</span>
                                </div>
                                <div class="total-row">
                                    <span>Tax (10%):</span>
                                    <span id="receipt-tax">$0.00</span>
                                </div>
                                <div class="total-row final-total">
                                    <span>Total:</span>
                                    <span id="receipt-total">$0.00</span>
                                </div>
                            </div>
                        </div>

                        <div class="receipt-actions">
                            <button class="btn btn-secondary" onclick="cancelReceipt()">Cancel</button>
                            <button class="btn btn-success" onclick="completeReceipt()" id="complete-receipt-btn" disabled>
                                <i class="fas fa-check"></i> Complete Sale
                            </button>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        // Simple test data
        const testProducts = [
            { id: 1, code: 'APL001', brand: 'Apple', model: 'iPhone 15 Pro', price: 999.99, stock: 25 },
            { id: 2, code: 'SAM002', brand: 'Samsung', model: 'Galaxy S24 Ultra', price: 899.99, stock: 30 },
            { id: 3, code: 'GOO003', brand: 'Google', model: 'Pixel 8 Pro', price: 699.99, stock: 15 }
        ];

        let currentReceipt = {
            items: [],
            subtotal: 0,
            tax: 0,
            total: 0
        };

        // Simple login
        document.getElementById('login-form').addEventListener('submit', function(e) {
            e.preventDefault();
            document.getElementById('login-container').style.display = 'none';
            document.getElementById('app-container').style.display = 'block';
            document.getElementById('welcome-message').textContent = 'Welcome, Test Staff';
            document.getElementById('user-role').textContent = 'Staff';
        });

        // Navigation
        document.addEventListener('click', function(e) {
            if (e.target.closest('.nav-item')) {
                const section = e.target.closest('.nav-item').dataset.section;
                if (section) {
                    document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
                    document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
                    document.getElementById(section).classList.add('active');
                    e.target.closest('.nav-item').classList.add('active');
                }
            }
        });

        // Add to receipt function
        function testAddToReceipt(productId) {
            console.log('Adding product', productId, 'to receipt');
            
            const product = testProducts.find(p => p.id === productId);
            if (!product) {
                alert('Product not found!');
                return;
            }

            // Check if already in receipt
            const existingItem = currentReceipt.items.find(item => item.productId === productId);
            
            if (existingItem) {
                existingItem.quantity++;
                existingItem.total = existingItem.quantity * existingItem.price;
            } else {
                currentReceipt.items.push({
                    productId: productId,
                    code: product.code,
                    name: `${product.brand} ${product.model}`,
                    price: product.price,
                    quantity: 1,
                    total: product.price
                });
            }

            updateReceiptDisplay();
            showReceiptBuilder();
            
            // Button feedback
            const button = event.target.closest('button');
            const originalText = button.innerHTML;
            button.innerHTML = '<i class="fas fa-check"></i> Added!';
            button.style.backgroundColor = '#28a745';
            setTimeout(() => {
                button.innerHTML = originalText;
                button.style.backgroundColor = '';
            }, 1500);

            showNotification(`${product.brand} ${product.model} added to receipt!`);
        }

        function showReceiptBuilder() {
            document.getElementById('receipt-builder').style.display = 'block';
            document.getElementById('receipt-builder').scrollIntoView({ behavior: 'smooth' });
        }

        function cancelReceipt() {
            document.getElementById('receipt-builder').style.display = 'none';
            currentReceipt.items = [];
            updateReceiptDisplay();
        }

        function updateReceiptDisplay() {
            const itemsList = document.getElementById('receipt-items-list');
            
            if (currentReceipt.items.length === 0) {
                itemsList.innerHTML = '<p class="no-items">No items added yet. Go to Inventory to add products.</p>';
            } else {
                itemsList.innerHTML = currentReceipt.items.map(item => `
                    <div class="receipt-item">
                        <div class="item-info">
                            <strong>${item.name}</strong>
                            <div class="item-code">Code: ${item.code}</div>
                        </div>
                        <div class="item-quantity">
                            <button class="qty-btn" onclick="changeQuantity(${item.productId}, -1)">-</button>
                            <span class="qty-display">${item.quantity}</span>
                            <button class="qty-btn" onclick="changeQuantity(${item.productId}, 1)">+</button>
                        </div>
                        <div class="item-price">$${item.price.toFixed(2)}</div>
                        <div class="item-total">$${item.total.toFixed(2)}</div>
                        <button class="btn-remove" onclick="removeFromReceipt(${item.productId})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                `).join('');
            }

            // Calculate totals
            const subtotal = currentReceipt.items.reduce((sum, item) => sum + item.total, 0);
            const tax = subtotal * 0.1;
            const total = subtotal + tax;

            document.getElementById('receipt-subtotal').textContent = `$${subtotal.toFixed(2)}`;
            document.getElementById('receipt-tax').textContent = `$${tax.toFixed(2)}`;
            document.getElementById('receipt-total').textContent = `$${total.toFixed(2)}`;

            document.getElementById('complete-receipt-btn').disabled = currentReceipt.items.length === 0;
        }

        function changeQuantity(productId, change) {
            const item = currentReceipt.items.find(item => item.productId === productId);
            if (!item) return;

            const newQuantity = item.quantity + change;
            if (newQuantity <= 0) {
                removeFromReceipt(productId);
            } else {
                item.quantity = newQuantity;
                item.total = item.quantity * item.price;
                updateReceiptDisplay();
            }
        }

        function removeFromReceipt(productId) {
            currentReceipt.items = currentReceipt.items.filter(item => item.productId !== productId);
            updateReceiptDisplay();
        }

        function completeReceipt() {
            const customerName = document.getElementById('receipt-customer').value.trim();
            if (!customerName) {
                alert('Please enter customer name');
                return;
            }
            alert('Receipt completed! (This is test mode - no database save)');
            cancelReceipt();
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'notification notification-success';
            notification.innerHTML = `<i class="fas fa-check-circle"></i><span>${message}</span>`;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        // Logout
        document.getElementById('logout-btn').addEventListener('click', function() {
            location.reload();
        });
    </script>
</body>
</html>
